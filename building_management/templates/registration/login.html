{% extends "base.html" %}
{% load i18n static %}
{% block title %}{% trans "Login" %} Â· {% trans "Building Management" %}{% endblock %}

{# Hide topbar content only on this page #}
{% block topbar_left %}{% endblock %}
{% block topbar_right %}
  {% get_current_language as LANGUAGE_CODE %}
  {% get_available_languages as AVAILABLE_LANGUAGES %}
  <form action="{% url 'set_language' %}" method="post" class="inline-flex items-center">
    {% csrf_token %}
    <input type="hidden" name="next" value="{{ request.get_full_path }}"/>
    <label for="id_language_login" class="sr-only">{% trans "Language" %}</label>
    <select id="id_language_login" name="language" class="btn btn-secondary btn-sm appearance-none pr-8" onchange="this.form.submit()">
      {% for code, name in AVAILABLE_LANGUAGES %}
        <option value="{{ code }}" {% if code == LANGUAGE_CODE %}selected{% endif %}>{{ name }}</option>
      {% endfor %}
    </select>
  </form>
{% endblock %}

{% block content %}
  <div class="flex min-h-[60vh] items-center justify-center">
    <div class="w-full max-w-md space-y-6 rounded-2xl bg-white p-6 shadow-card dark:bg-slate-900">
      <header class="space-y-2 text-center">
        <h1 class="text-2xl font-semibold text-brand-foreground dark:text-white">{% trans "Sign in" %}</h1>
      </header>

      {% if form.non_field_errors %}
        <div class="alert alert--danger">
          {% for err in form.non_field_errors %}
            <div>{{ err }}</div>
          {% endfor %}
        </div>
      {% endif %}

      <form method="post" action="{% url 'login' %}" class="space-y-4" novalidate>
        {% csrf_token %}

        <div class="space-y-1">
          <label for="{{ form.username.id_for_label }}">{% trans "Username" %}</label>
          {{ form.username }}
          {% if form.username.errors %}
            <div class="errors">
              {% for err in form.username.errors %}<div>{{ err }}</div>{% endfor %}
            </div>
          {% endif %}
        </div>

        <div class="space-y-1">
          <label for="{{ form.password.id_for_label }}">{% trans "Password" %}</label>
          {{ form.password }}
          {% if form.password.errors %}
            <div class="errors">
              {% for err in form.password.errors %}<div>{{ err }}</div>{% endfor %}
            </div>
          {% endif %}
        </div>

        <button class="btn w-full justify-center" type="submit">{% trans "Sign in" %}</button>
      </form>
    </div>
  </div>
{% endblock %}
