{% load i18n %}
{# Generic form layout used by all create/update pages #}
<section class="space-y-6">
  <header class="space-y-1">
    <h1 class="text-2xl font-semibold text-brand-foreground dark:text-white">{{ title }}</h1>
    {% if subtitle %}<p class="text-sm text-slate-500 dark:text-slate-400">{{ subtitle }}</p>{% endif %}
  </header>

  <form method="post" novalidate class="space-y-6">
    {% csrf_token %}
    {% if next_url %}
      <input type="hidden" name="next" value="{{ next_url }}"/>
    {% endif %}

    {% if form.non_field_errors %}
      <div class="alert alert--danger">
        {% for e in form.non_field_errors %}<div>{{ e }}</div>{% endfor %}
      </div>
    {% endif %}

    {% for h in form.hidden_fields %}
      {{ h }}
      {% if h.errors %}
        <div class="errors">{% for e in h.errors %}<div>{{ e }}</div>{% endfor %}</div>
      {% endif %}
    {% endfor %}

    <div class="grid gap-5">
      {% for field in form.visible_fields %}
        {% if field.field.widget.input_type == 'checkbox' %}
          <div class="space-y-1">
            <label class="inline-flex items-center gap-2 text-sm font-medium text-slate-700 dark:text-slate-200">
              {{ field }}
              <span>{{ field.label }}</span>
            </label>
            {% if field.help_text %}<div class="help">{{ field.help_text|safe }}</div>{% endif %}
            {% if field.errors %}
              <div class="errors">{% for e in field.errors %}<div>{{ e }}</div>{% endfor %}</div>
            {% endif %}
          </div>
        {% else %}
          <div class="space-y-1">
            <label for="{{ field.id_for_label }}">{{ field.label }}</label>
            {{ field }}
            {% if field.help_text %}<div class="help">{{ field.help_text|safe }}</div>{% endif %}
            {% if field.errors %}
              <div class="errors">{% for e in field.errors %}<div>{{ e }}</div>{% endfor %}</div>
            {% endif %}
          </div>
        {% endif %}
      {% endfor %}
    </div>

    <div class="flex flex-wrap gap-3">
      <button class="btn" type="submit">{% trans "Save" %}</button>
      <a class="btn" href="{{ cancel_url|default:'javascript:history.back()' }}">{% trans "Cancel" %}</a>
    </div>
  </form>
</section>
