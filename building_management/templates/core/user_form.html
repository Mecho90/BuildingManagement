{% extends "base.html" %}
{% load i18n %}
{% block title %}
  {% if form.instance.pk %}{% trans "Edit user" %}{% else %}{% trans "Add user" %}{% endif %} Â· {% trans "Building Management" %}
{% endblock %}
{% block content %}
<section class="space-y-6">
  <header>
    <h1 class="text-3xl font-semibold text-brand-foreground dark:text-white">
      {% if form.instance.pk %}{% trans "Edit user" %}{% else %}{% trans "Add user" %}{% endif %}
    </h1>
    <p class="text-sm text-slate-500 dark:text-slate-400">
      {% if form.instance.pk %}
        {% trans "Update account details, flags, and contact information." %}
      {% else %}
        {% trans "Create a new account and assign the right access level." %}
      {% endif %}
    </p>
  </header>

  <form method="post" class="space-y-6 rounded-2xl border border-slate-200 bg-white p-6 shadow-card dark:border-slate-700 dark:bg-slate-900">
    {% csrf_token %}
    {% if form.non_field_errors %}
      <div class="alert alert--error">
        {{ form.non_field_errors }}
      </div>
    {% endif %}

    <div class="grid gap-4 md:grid-cols-2">
      {% for field in form %}
        {% if field.field.widget.input_type == "checkbox" %}
          <div class="md:col-span-2">
            <label class="flex items-start gap-3 rounded-xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm font-medium text-slate-600 dark:border-slate-700 dark:bg-slate-800 dark:text-slate-200">
              {{ field }}
              <span>
                {{ field.label }}
                {% if field.help_text %}
                  <span class="block text-xs font-normal text-slate-500 dark:text-slate-400">{{ field.help_text }}</span>
                {% endif %}
              </span>
            </label>
            {% if field.errors %}
              <p class="mt-1 text-sm text-rose-600 dark:text-rose-400">{{ field.errors|striptags }}</p>
            {% endif %}
          </div>
        {% else %}
          <div class="space-y-1">
            <label for="{{ field.id_for_label }}" class="block text-sm font-medium text-slate-600 dark:text-slate-300">
              {{ field.label }}
            </label>
            {% if field.help_text %}
              <p class="text-xs text-slate-500 dark:text-slate-400">{{ field.help_text }}</p>
            {% endif %}
            {{ field }}
            {% if field.errors %}
              <p class="text-sm text-rose-600 dark:text-rose-400">{{ field.errors|striptags }}</p>
            {% endif %}
          </div>
        {% endif %}
      {% endfor %}
    </div>

    <div class="rounded-xl border border-dashed border-slate-300 p-4 text-sm text-slate-500 dark:border-slate-700 dark:text-slate-400">
      <h2 class="text-base font-semibold text-brand-foreground dark:text-white">{% trans "Roles" %}</h2>
      <p>{% trans "Role assignment will be available in a future update." %}</p>
    </div>

    <div class="flex flex-wrap justify-end gap-3">
      <button class="btn" type="submit">{% trans "Save" %}</button>
      <a class="btn btn-secondary" href="{% url 'users_list' %}">{% trans "Cancel" %}</a>
    </div>
  </form>
</section>
{% endblock %}
