{% load static %}
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <title>{% block title %}Building Management{% endblock %}</title>

    {# Your stylesheet (still loaded) #}
    <link rel="stylesheet" href="{% static 'css/app.css' %}?v={% now 'U' %}"/>

    {% block extra_css %}{% endblock %}
  </head>

  <body class="{% block body_class %}{% endblock %}">
    <!-- Top bar -->
    <header style="border-bottom:1px solid #eef2f6; background:#fff;">
      <div style="max-width:1100px; margin:0 auto; padding:.75rem 1rem;">
        <!-- FLEX ROW: left group (nav) vs right group (greeting) -->
        <div style="display:flex; justify-content:space-between; align-items:center; gap:1rem;">
          <!-- LEFT: primary navigation -->
          <nav style="display:flex; gap:1rem; align-items:center;" aria-label="Primary">
            {% block topbar_left %}
              <a href="{% url 'buildings_list' %}" style="text-decoration:none; color:#1e90ff;">Buildings</a>
              {% if work_orders_enabled and work_orders_url %}
                <a href="{{ work_orders_url }}" style="text-decoration:none; color:#1e90ff;">Work Orders</a>
              {% endif %}
              {% if user.is_staff %}
                <a href="{% url 'admin:index' %}" style="text-decoration:none; color:#1e90ff;">Admin Panel</a>
              {% endif %}
            {% endblock %}
          </nav>

          <!-- RIGHT: date, greeting, logout -->
          <div style="display:flex; gap:.75rem; align-items:center; white-space:nowrap;">
            {% block topbar_right %}
              {% if user.is_authenticated %}
                <time datetime="{% now 'c' %}" style="color:#6b7280;">{% now 'D, M j, Y' %}</time>
                <span style="color:#6b7280;">Welcome, {{ user.get_full_name|default:user.username }}</span>
                <form action="{% url 'logout' %}" method="post" style="display:inline;">
                  {% csrf_token %}
                  <button type="submit" class="btn btn-secondary">Logout</button>
                </form>
              {% else %}
                <a class="btn" href="{% url 'login' %}">Login</a>
              {% endif %}
            {% endblock %}
          </div>
        </div>

        {% if messages %}
          <div style="margin-top:.5rem;">
            {% for message in messages %}
              <div class="alert">{{ message }}</div>
            {% endfor %}
          </div>
        {% endif %}
      </div>
    </header>

    <!-- Main content -->
    <main style="max-width:1100px; margin:1.25rem auto; padding:0 1rem;">
      {% block content %}{% endblock %}
    </main>

    {% block extra_js %}{% endblock %}
  </body>
</html>
